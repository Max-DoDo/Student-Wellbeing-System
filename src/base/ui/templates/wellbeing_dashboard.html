{% extends "base.html" %}
{% block content %}
<style>
   .dashboard-card {
      transition: 0.25s ease;
      border-radius: 12px;
      cursor: pointer;
      border: none !important;
      background: white;
   }

   .dashboard-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.18) !important;
   }

   .dashboard-icon {
      font-size: 42px;
      color: #4a69bd;
      margin-bottom: 10px;
   }

   .dashboard-value {
      font-size: 26px;
      font-weight: bold;
   }

   .modern-table {
      border-collapse: separate;
      border-spacing: 0;
      width: 100%;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
   }

   .modern-table thead {
      background: #f1f3f7;
      font-weight: 600;
   }

   .modern-table th,
   .modern-table td {
      padding: 14px 18px;
      font-size: 15px;
      vertical-align: middle;
   }

   .modern-table tbody tr {
      transition: 0.2s ease;
   }

   .modern-table tbody tr:hover {
      background: #f9fbff;
      transform: scale(1.01);
   }

   .risk-high {
      background: #ffe5e5 !important;
   }

   .risk-high:hover {
      background: #ffdcdc !important;
   }

   .btn-view {
      font-size: 14px;
      padding: 6px 14px;
      border-radius: 6px;
   }
</style>
<div class="container mt-4">

   <h2 class="fw-bold mb-2">ðŸŒ¿ Wellbeing Dashboard</h2>
   <p class="text-muted mb-4">Welcome! Hereâ€™s an overview of student wellbeing insights.</p>
   <hr>

   <div class="row mb-4">

      <div class="col-md-4">
         <div class="card dashboard-card text-center p-4 shadow-sm">
            <i class="bi bi-people-fill dashboard-icon"></i>
            <h4>Total Students</h4>
            <p class="dashboard-value">{{ total_students }}</p>
         </div>
      </div>

      <div class="col-md-4">
         <div class="card dashboard-card text-center p-4 shadow-sm">
            <i class="bi bi-emoji-neutral dashboard-icon"></i>
            <h4>Average Stress</h4>
            <p class="dashboard-value text-danger">{{ avg_stress }}</p>
         </div>
      </div>

      <div class="col-md-4">
         <div class="card dashboard-card text-center p-4 shadow-sm">
            <i class="bi bi-moon-stars dashboard-icon"></i>
            <h4>Average Sleep</h4>
            <p class="dashboard-value text-success">{{ avg_sleep }} hrs</p>
         </div>
      </div>
   </div>
   <hr>

   <h3 class="mb-2">âš  High-Risk Students</h3>
   <p class="text-muted mb-3">Detected by: High stress or low sleep</p>
   {% if high_risk_students %}
   <div class="card p-4 shadow-sm">
      <table class="modern-table">
         <thead>
            <tr>
               <th>Name</th>
               <th>Avg Stress</th>
               <th>Avg Sleep</th>
               <th style="width: 140px; text-align:center;">View Report</th>
            </tr>
         </thead>
         <tbody>
            {% for s in high_risk_students %}
            <tr class="risk-high">
               <td>{{ s.name }}</td>
               <td>{{ s.avg_stress }}</td>
               <td>{{ s.avg_sleep }} hrs</td>
               <td class="text-center">
                  <a class="btn btn-primary btn-view" href="{{ url_for('wellbeing_student_detail', sid=s.id) }}">
                     View â†’
                  </a>
               </td>
            </tr>
            {% endfor %}
         </tbody>
      </table>
   </div>
   {% else %}
   <p class="text-muted">âœ” No high-risk students found.</p>
   {% endif %}
</div>
{% endblock %}